---
layout: api
page_title: Consistency Modes
description: >-
  Consistency modes allow consumers of the Consul HTTP API to make trade-offs
  according to their needs between the level of consistency and performance
  of read requests.
---

# Consistency Modes

Consistency modes allow consumers of the Consul HTTP API to make trade-offs
according to their needs between the level of consistency and performance
of read requests.

## Available Modes

Each HTTP API endpoint documents its support for the three read consistency modes:

- `default` - If not specified, the default is strongly consistent in almost all
  cases. However, there is a small window in which a new leader may be elected
  during which the old leader may service stale values. The trade-off is fast
  reads but potentially stale values. The condition resulting in stale reads is
  hard to trigger, and most clients should not need to worry about this case.
  Also, note that this race condition only applies to reads, not writes.

- `consistent` - This mode is strongly consistent without caveats. It requires
  that a leader verify with a quorum of peers that it is still leader. This
  introduces an additional round-trip to all server nodes. The trade-off is
  increased latency due to an extra round trip. Most clients should not use this
  unless they cannot tolerate a stale read.

- `stale` - This mode allows any server to service the read regardless of
  whether it is the leader. This means reads can be arbitrarily stale; however,
  results are generally consistent to within 50 milliseconds of the leader. The
  trade-off is very fast and scalable reads with a higher likelihood of stale
  values. Since this mode allows reads without a leader, a cluster that is
  unavailable will still be able to respond to queries.

  ~> **Scaling read requests**: horizontally scaling Consul servers under
  heavy request load will only help if many of the requests are `stale` reads.
  This is because `stale` reads are the only requests that can be handled by
  server agents other than the leader. Other requests will always be handled
  by the leader no matter the number of Consul servers.
  Only `stale` requests benefit from the enhanced read scalability provided by
  [read replicas](/docs/enterprise/read-scale) and
  [redundancy zones](/docs/enterprise/redundancy).


### Intra-Datacenter Request Behavior

The following diagrams show how the intra-datacenter request path varies
per consistency mode and the relative trade-offs between level of consistency and performance.

<Tabs>
<Tab heading="Stale reads">

[![stale consistency mode read request path](/img/consistency-modes/consistency-mode-stale.png)](/img/consistency-modes/consistency-mode-stale.png)

</Tab>

<Tab heading="Default reads">

[![default consistency mode read request path](/img/consistency-modes/consistency-mode-default.png)](/img/consistency-modes/consistency-mode-default.png)

</Tab>
<Tab heading="Consistent reads, all writes">

[![consistent consistency mode read, any write request path](/img/consistency-modes/consistency-mode-consistent.png)](/img/consistency-modes/consistency-mode-consistent.png)

</Tab>
</Tabs>

### Cross-Datacenter Request Behavior

When making a request across federated Consul datacenters, requests are forwarded from
a local server to any remote server. Once in the remote datecenter, the request path
is the same as a [local request with the same consistency mode](#intra-datacenter-request-behavior).

[![consistency mode behavior across Consul datacenters](/img/consistency-modes/consistency-mode-cross-datacenter.png)](/img/consistency-modes/consistency-mode-cross-datacenter.png)

## Usage

### Consistency Mode Defaults and Overriding

#### Consul DNS Queries

When DNS queries are issued to [Consul's DNS interface](/docs/discovery/dns),
Consul uses the `stale` consistency mode by default when interfacing with the
underlying Consul service discovery HTTP APIs
([catalog](/api-docs/catalog), [health](/api-docs/health), and [query](/api-docs/query)).
To set an upper limit on how stale results are allowed to be,
specify [`dns_config.max_stale`](/docs/agent/options#max_stale)
in the configuration of the Consul agent serving DNS queries.

If stronger consistency is required at the expense of increased latency,
set [`dns_config.allow_stale`](/docs/agent/options#allow_stale) to `false`
to make Consul use the `default` consistency mode when interfacing with the
underlying Consul service discovery HTTP APIs.

The consistency mode underlying Consul DNS queries cannot be overridden on a
per-request basis.

#### Consul HTTP API Queries

All HTTP API read requests use the `default` consistency mode by default
unless overridden on a per-request basis.

Only the service discovery HTTP API endpoints
([catalog](/api-docs/catalog), [health](/api-docs/health), and [query](/api-docs/query))
allow changing the consistency mode used by default. By setting
[`discovery_max_stale`](/docs/agent/options#discovery_max_stale)
to a value greater than zero in the configuration of the Consul agent receiving requests,
the `stale` consistency mode will be used by default unless the data is sufficiently stale.
Setting a positive value for [`discovery_max_stale`](/docs/agent/options#discovery_max_stale)
is analogous to changing the default consistency mode for
[Consul DNS queries](#consul-dns-queries) by setting [`dns_config.max_stale`](/docs/agent/options#max_stale).

The HTTP API documentation for each endpoint lists which consistency modes can be used
to override the default on a per-request basis. To use a supported consistency mode
other than `default` for a request,
include the desired consistency mode—`stale` or `consistent`—as a
query parameter in the request.

### Visibility into Response Staleness

To support bounding the acceptable staleness of data, responses provide the
`X-Consul-LastContact` header containing the time in milliseconds that a server
was last contacted by the leader node. The `X-Consul-KnownLeader` header also
indicates if there is a known leader. These can be used by clients to gauge the
staleness of a result and take appropriate action.

### Relationship to Request Caching

Note that some HTTP API endpoints support a `cached` parameter which has some of the same
semantics as `stale` consistency mode but different trade offs. This behavior is described in
[agent caching feature documentation](/api/features/caching).
